branches:
  only:
    - master
language: node_js
node_js:
  - '14'
os: 
  linux 
arch:
  arm64 
dist: 
  bionic
  
before_install:
  - sudo apt-get update
  - sudo apt-get install -y gpg
  - wget -O - https://packages.microsoft.com/keys/microsoft.asc | gpg --dearmor -o microsoft.asc.gpg
  - sudo mv microsoft.asc.gpg /etc/apt/trusted.gpg.d/
  - wget https://packages.microsoft.com/config/ubuntu/{os-version}/prod.list
  - sudo mv prod.list /etc/apt/sources.list.d/microsoft-prod.list
  - sudo chown root:root /etc/apt/trusted.gpg.d/microsoft.asc.gpg
  - sudo chown root:root /etc/apt/sources.list.d/microsoft-prod.list
  - sudo apt-get update 
  - sudo apt-get install -y apt-transport-https
  - sudo apt-get update 
  - sudo apt-get install -y dotnet-runtime-3.1
install:
  - cd bot
  - npm i
  - npm i --only=dev
  - cd ..
  - cd backend
  - npm i 
  - npm i --only=dev
  - cd ..
  - cd frontend
  - npm i 
  
script: 
  - cd bot
  - tsc
  - npm run test
  - cd ..
  - cd backend
  - tsc
  - cd ..
  - cd frontend
  - npm run build   
  